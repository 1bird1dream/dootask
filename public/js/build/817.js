(self.webpackChunkDooTask=self.webpackChunkDooTask||[]).push([[817],{68817:(o,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>i});const t={data:function(){return{loadIng:0,codeNeed:!1,codeUrl:this.$store.state.method.apiUrl("users/login/codeimg"),loginType:"login",email:"",password:"",password2:"",code:""}},methods:{forgotPassword:function(){$A.modalWarning("请联系管理员！")},reCode:function(){this.codeUrl=this.$store.state.method.apiUrl("users/login/codeimg?_="+Math.random())},onBlur:function(){var o=this;"login"==this.loginType?(this.loadIng++,this.$store.dispatch("call",{url:"users/login/needcode",data:{email:this.email}}).then((function(){o.loadIng--,o.reCode(),o.codeNeed=!0})).catch((function(){o.loadIng--,o.codeNeed=!1}))):this.codeNeed=!1},onLogin:function(){var o=this;this.email&&this.password&&("reg"!=this.loginType||this.password==this.password2?(this.loadIng++,this.$store.dispatch("call",{url:"users/login",data:{type:this.loginType,email:this.email,password:this.password,code:this.code}}).then((function(e){var s=e.data;o.loadIng--,o.$store.state.method.clearLocal(),o.$store.dispatch("saveUserInfo",s),o.goNext()})).catch((function(e){var s=e.data,t=e.msg;o.loadIng--,$A.noticeError(t),"need"===s.code&&(o.reCode(),o.codeNeed=!0)}))):$A.noticeError("确认密码输入不一致"))},goNext:function(){var o=decodeURIComponent($A.getObject(this.$route.query,"from"));o?window.location.replace(o):this.goForward({path:"/manage/dashboard"},!0)}}};const i=(0,s(51900).Z)(t,(function(){var o=this,e=o.$createElement,s=o._self._c||e;return s("div",{staticClass:"page-login"},[s("PageTitle",{attrs:{title:o.$L("登录")}}),o._v(" "),s("div",{staticClass:"login-body"},[s("div",{staticClass:"login-logo"}),o._v(" "),s("div",{staticClass:"login-box"},[s("div",{staticClass:"login-title"},[o._v("Welcome Dootask")]),o._v(" "),"reg"==o.loginType?s("div",{staticClass:"login-subtitle"},[o._v(o._s(o.$L("输入您的信息以创建帐户。")))]):s("div",{staticClass:"login-subtitle"},[o._v(o._s(o.$L("输入您的凭证以访问您的帐户。")))]),o._v(" "),s("div",{staticClass:"login-input"},[s("Input",{attrs:{prefix:"ios-mail-outline",placeholder:o.$L("输入您的电子邮件"),size:"large"},on:{"on-enter":o.onLogin,"on-blur":o.onBlur},model:{value:o.email,callback:function(e){o.email=e},expression:"email"}}),o._v(" "),s("Input",{attrs:{prefix:"ios-lock-outline",placeholder:o.$L("输入您的密码"),type:"password",size:"large"},on:{"on-enter":o.onLogin},model:{value:o.password,callback:function(e){o.password=e},expression:"password"}}),o._v(" "),"reg"==o.loginType?s("Input",{attrs:{prefix:"ios-lock-outline",placeholder:o.$L("输入确认密码"),type:"password",size:"large"},on:{"on-enter":o.onLogin},model:{value:o.password2,callback:function(e){o.password2=e},expression:"password2"}}):o._e(),o._v(" "),o.codeNeed?s("Input",{staticClass:"login-code",attrs:{placeholder:o.$L("输入图形验证码"),size:"large"},on:{"on-enter":o.onLogin},model:{value:o.code,callback:function(e){o.code=e},expression:"code"}},[s("Icon",{staticClass:"login-icon",attrs:{slot:"prepend",type:"ios-checkmark-circle-outline"},slot:"prepend"}),o._v(" "),s("div",{staticClass:"login-code-end",attrs:{slot:"append"},on:{click:o.reCode},slot:"append"},[s("img",{attrs:{src:o.codeUrl}})])],1):o._e(),o._v(" "),s("Button",{attrs:{type:"primary",loading:o.loadIng>0,size:"large",long:""},on:{click:o.onLogin}},[o._v(o._s(o.$L("login"==o.loginType?"登录":"注册")))]),o._v(" "),"reg"==o.loginType?s("div",{staticClass:"login-switch"},[o._v(o._s(o.$L("已经有帐号？"))),s("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){o.loginType="login"}}},[o._v(o._s(o.$L("登录帐号")))])]):s("div",{staticClass:"login-switch"},[o._v(o._s(o.$L("还没有帐号？"))),s("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){o.loginType="reg"}}},[o._v(o._s(o.$L("注册帐号")))])])],1)]),o._v(" "),s("div",{staticClass:"login-forgot"},[o._v(o._s(o.$L("忘记密码了？"))),s("a",{attrs:{href:"javascript:void(0)"},on:{click:o.forgotPassword}},[o._v(o._s(o.$L("重置密码")))])])])],1)}),[],!1,null,null,null).exports}}]);