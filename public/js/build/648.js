(self.webpackChunkDooTask=self.webpackChunkDooTask||[]).push([[648],{9648:(o,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>i});const s={data:function(){return{loadIng:0,codeNeed:!1,codeUrl:this.$store.state.method.apiUrl("users/login/codeimg"),loginType:"login",email:"",password:"",password2:"",code:""}},computed:{currentLanguage:function(){return this.languageList[this.languageType]||"Language"}},methods:{forgotPassword:function(){$A.modalWarning("请联系管理员！")},reCode:function(){this.codeUrl=this.$store.state.method.apiUrl("users/login/codeimg?_="+Math.random())},onBlur:function(){var o=this;"login"==this.loginType&&this.email?(this.loadIng++,this.$store.dispatch("call",{url:"users/login/needcode",data:{email:this.email}}).then((function(){o.loadIng--,o.reCode(),o.codeNeed=!0})).catch((function(){o.loadIng--,o.codeNeed=!1}))):this.codeNeed=!1},onLogin:function(){var o=this;this.email&&this.password&&("reg"!=this.loginType||this.password==this.password2?(this.loadIng++,this.$store.dispatch("call",{url:"users/login",data:{type:this.loginType,email:this.email,password:this.password,code:this.code}}).then((function(e){var t=e.data;o.loadIng--,o.$store.state.method.clearLocal(),o.$store.dispatch("saveUserInfo",t),o.goNext()})).catch((function(e){var t=e.data,s=e.msg;o.loadIng--,$A.noticeError(s),"need"===t.code&&(o.reCode(),o.codeNeed=!0)}))):$A.noticeError("确认密码输入不一致"))},goNext:function(){var o=decodeURIComponent($A.getObject(this.$route.query,"from"));o?window.location.replace(o):this.goForward({path:"/manage/dashboard"},!0)}}};const i=(0,t(51900).Z)(s,(function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"page-login"},[t("PageTitle",{attrs:{title:o.$L("登录")}}),o._v(" "),t("div",{staticClass:"login-body"},[t("div",{staticClass:"login-logo"}),o._v(" "),t("div",{staticClass:"login-box"},[t("div",{staticClass:"login-title"},[o._v("Welcome Dootask")]),o._v(" "),"reg"==o.loginType?t("div",{staticClass:"login-subtitle"},[o._v(o._s(o.$L("输入您的信息以创建帐户。")))]):t("div",{staticClass:"login-subtitle"},[o._v(o._s(o.$L("输入您的凭证以访问您的帐户。")))]),o._v(" "),t("div",{staticClass:"login-input"},[t("Input",{attrs:{prefix:"ios-mail-outline",placeholder:o.$L("输入您的电子邮件"),size:"large"},on:{"on-enter":o.onLogin,"on-blur":o.onBlur},model:{value:o.email,callback:function(e){o.email=e},expression:"email"}}),o._v(" "),t("Input",{attrs:{prefix:"ios-lock-outline",placeholder:o.$L("输入您的密码"),type:"password",size:"large"},on:{"on-enter":o.onLogin},model:{value:o.password,callback:function(e){o.password=e},expression:"password"}}),o._v(" "),"reg"==o.loginType?t("Input",{attrs:{prefix:"ios-lock-outline",placeholder:o.$L("输入确认密码"),type:"password",size:"large"},on:{"on-enter":o.onLogin},model:{value:o.password2,callback:function(e){o.password2=e},expression:"password2"}}):o._e(),o._v(" "),o.codeNeed?t("Input",{staticClass:"login-code",attrs:{placeholder:o.$L("输入图形验证码"),size:"large"},on:{"on-enter":o.onLogin},model:{value:o.code,callback:function(e){o.code=e},expression:"code"}},[t("Icon",{staticClass:"login-icon",attrs:{slot:"prepend",type:"ios-checkmark-circle-outline"},slot:"prepend"}),o._v(" "),t("div",{staticClass:"login-code-end",attrs:{slot:"append"},on:{click:o.reCode},slot:"append"},[t("img",{attrs:{src:o.codeUrl}})])],1):o._e(),o._v(" "),t("Button",{attrs:{type:"primary",loading:o.loadIng>0,size:"large",long:""},on:{click:o.onLogin}},[o._v(o._s(o.$L("login"==o.loginType?"登录":"注册")))]),o._v(" "),"reg"==o.loginType?t("div",{staticClass:"login-switch"},[o._v(o._s(o.$L("已经有帐号？"))),t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){o.loginType="login"}}},[o._v(o._s(o.$L("登录帐号")))])]):t("div",{staticClass:"login-switch"},[o._v(o._s(o.$L("还没有帐号？"))),t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){o.loginType="reg"}}},[o._v(o._s(o.$L("注册帐号")))])])],1)]),o._v(" "),t("div",{staticClass:"login-bottom"},[t("Dropdown",{attrs:{trigger:"click",transfer:""},on:{"on-click":o.setLanguage}},[t("div",{staticClass:"login-language"},[o._v("\n                    "+o._s(o.currentLanguage)+"\n                    "),t("i",{staticClass:"taskfont"},[o._v("")])]),o._v(" "),t("Dropdown-menu",{attrs:{slot:"list"},slot:"list"},o._l(o.languageList,(function(e,s){return t("Dropdown-item",{key:s,attrs:{name:s,selected:o.getLanguage()===s}},[o._v(o._s(e))])})),1)],1),o._v(" "),t("div",{staticClass:"login-forgot"},[o._v(o._s(o.$L("忘记密码了？"))),t("a",{attrs:{href:"javascript:void(0)"},on:{click:o.forgotPassword}},[o._v(o._s(o.$L("重置密码")))])])],1)])],1)}),[],!1,null,null,null).exports}}]);