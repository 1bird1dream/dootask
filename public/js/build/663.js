"use strict";(self.webpackChunkDooTask=self.webpackChunkDooTask||[]).push([[663],{32663:(t,s,a)=>{a.r(s),a.d(s,{default:()=>c});var e=a(20629);function o(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter((function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),a.push.apply(a,e)}return a}function n(t){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?o(Object(a),!0).forEach((function(s){i(t,s,a[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))}))}return t}function i(t,s,a){return s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}const r={components:{TaskMenu:a(55299).Z},data:function(){return{nowTime:$A.Time(),nowInterval:null,loadIng:0,dashboard:"today"}},mounted:function(){var t=this;this.nowInterval=setInterval((function(){t.nowTime=$A.Time()}),1e3)},destroyed:function(){clearInterval(this.nowInterval)},activated:function(){this.$store.dispatch("getTaskForDashboard")},deactivated:function(){this.$store.dispatch("forgetTaskCompleteTemp",!0)},computed:n(n(n({},(0,e.rn)(["userInfo","cacheProjects","taskId"])),(0,e.Se)(["dashboardTask","transforTasks"])),{},{title:function(){switch(this.dashboard){case"today":return this.$L("今日任务");case"overdue":return this.$L("超期任务");case"all":return this.$L("待完成任务");default:return""}},list:function(){var t=[];switch(this.dashboard){case"today":t=this.transforTasks(this.dashboardTask.today);break;case"overdue":t=this.transforTasks(this.dashboardTask.overdue);break;case"all":t=this.transforTasks(this.dashboardTask.all)}return t.sort((function(t,s){if(t.end_at||s.end_at)return $A.Date(t.end_at)-$A.Date(s.end_at)}))}}),methods:{openTask:function(t){this.$store.dispatch("openTask",t)},openMenu:function(t){var s=this.$refs["taskMenu_".concat(t.id)];s&&s[0].handleClick()},expiresFormat:function(t){return $A.countDownFormat(t,this.nowTime)}}};const c=(0,a(51900).Z)(r,(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"page-dashboard"},[a("PageTitle",{attrs:{title:t.$L("仪表盘")}}),t._v(" "),a("div",{staticClass:"dashboard-wrapper"},[a("div",{staticClass:"dashboard-hello"},[t._v(t._s(t.$L("欢迎您，"+t.userInfo.nickname)))]),t._v(" "),a("div",{staticClass:"dashboard-desc"},[t._v(t._s(t.$L("以下是你当前的任务统计数据")))]),t._v(" "),a("ul",{staticClass:"dashboard-block"},[a("li",{on:{click:function(s){t.dashboard="today"}}},[a("div",{staticClass:"block-title"},[t._v(t._s(t.$L("今日待完成")))]),t._v(" "),a("div",{staticClass:"block-data"},[a("div",{staticClass:"block-num"},[t._v(t._s(t.dashboardTask.today.length))]),t._v(" "),a("i",{staticClass:"taskfont"},[t._v("")])])]),t._v(" "),a("li",{on:{click:function(s){t.dashboard="overdue"}}},[a("div",{staticClass:"block-title"},[t._v(t._s(t.$L("超期未完成")))]),t._v(" "),a("div",{staticClass:"block-data"},[a("div",{staticClass:"block-num"},[t._v(t._s(t.dashboardTask.overdue.length))]),t._v(" "),a("i",{staticClass:"taskfont"},[t._v("")])])]),t._v(" "),a("li",{on:{click:function(s){t.dashboard="all"}}},[a("div",{staticClass:"block-title"},[t._v(t._s(t.$L("待完成任务")))]),t._v(" "),a("div",{staticClass:"block-data"},[a("div",{staticClass:"block-num"},[t._v(t._s(t.dashboardTask.all.length))]),t._v(" "),a("i",{staticClass:"taskfont"},[t._v("")])])])]),t._v(" "),t.list.length>0?[a("div",{staticClass:"dashboard-title"},[t._v(t._s(t.title))]),t._v(" "),a("ul",{staticClass:"dashboard-list overlay-y"},t._l(t.list,(function(s,e){return a("li",{key:e,class:{complete:s.complete_at},style:s.color?{backgroundColor:s.color}:{},on:{click:function(a){return t.openTask(s)}}},[s.p_name?a("em",{staticClass:"priority-color",style:{backgroundColor:s.p_color}}):t._e(),t._v(" "),a("TaskMenu",{ref:"taskMenu_"+s.id,refInFor:!0,attrs:{task:s}},[a("div",{staticClass:"drop-icon",attrs:{slot:"icon"},on:{click:function(t){t.stopPropagation()}},slot:"icon"},[a("i",{staticClass:"taskfont",domProps:{innerHTML:t._s(s.complete_at?"&#xe627;":"&#xe625;")}})])]),t._v(" "),a("div",{staticClass:"item-title"},[s.flow_item_name?a("span",{class:s.flow_item_status,on:{click:function(a){return a.stopPropagation(),t.openMenu(s)}}},[t._v(t._s(s.flow_item_name))]):t._e(),t._v(" "),!0===s.sub_top?a("span",[t._v(t._s(t.$L("子任务")))]):t._e(),t._v(" "),s.sub_my&&s.sub_my.length>0?a("span",[t._v("+"+t._s(s.sub_my.length))]):t._e(),t._v(" "),t._v("\n                        "+t._s(s.name)+"\n                    ")]),t._v(" "),s.desc?a("div",{staticClass:"item-icon"},[a("i",{staticClass:"taskfont"},[t._v("")])]):t._e(),t._v(" "),s.sub_num>0?a("div",{staticClass:"item-icon"},[a("i",{staticClass:"taskfont"},[t._v("")]),t._v(" "),a("em",[t._v(t._s(s.sub_complete)+"/"+t._s(s.sub_num))])]):t._e(),t._v(" "),s.end_at?a("ETooltip",{attrs:{content:s.end_at,placement:"right"}},[a("div",{class:["item-icon",s.today?"today":"",s.overdue?"overdue":""]},[a("i",{staticClass:"taskfont"},[t._v("")]),t._v(" "),a("em",[t._v(t._s(t.expiresFormat(s.end_at)))])])]):t._e()],1)})),0)]:t._e()],2)],1)}),[],!1,null,null,null).exports}}]);